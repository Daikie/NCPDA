<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-Control" content="no-cache">
<meta http-equiv="Expires" content="0">
<meta name="viewport" content="width=device-width, user-scalable=no, maximum-scale=1" />
<link rel="stylesheet" href="css/bootstrap.css">
<link rel="stylesheet" href="css/styles.css">
<title>西小山クリニック</title>

<script type="text/javascript">
	function Otpw(){
		var today = new Date();
		var y = String(today.getFullYear());
		var m = ("0"+String(today.getMonth()+1)).slice(-2);
		var d = ("0"+String(today.getDate())).slice(-2);
		var a = y+m+d;
		var b = [];
		for(var i=0; i<7; i++) {
			b[i] = Number(a[i+1])-Number(a[i]);
			if(b[i]<0) {
				b[i] = b[i]+10;
			}
		}
		const reducer = (accumulator, currentValue) => accumulator + currentValue;
		chk = b.reduce(reducer)%10;
		bas = a[0];
		target1 = document.getElementById("main-content1");
		target1.innerHTML = chk + bas + b.join("");
	}

	function Adv(){
		var today = new Date();
		var y = String(today.getFullYear());
		var m = ("0"+String(today.getMonth()+1)).slice(-2);
		var d = ("0"+String(today.getDate())).slice(-2);
		// Old Advance
		var a = y+m+d;
		var b = [];
		for(var i=0; i<7; i++) {
			b[i] = Number(a[i+1])-Number(a[i]);
			if(b[i]<0) {
				b[i] = b[i]+10;
			}
		}
		const reducer = (accumulator, currentValue) => accumulator + currentValue;
		chk = b.reduce(reducer)%10;
		bas = a[0];
		target2 = document.getElementById("main-content2");
		target2.innerHTML = "<p><a href='https://daikie.github.io/NCPDA/refill.html?ID=" + chk + bas + b.join("") +"'>Old Advance</a></p>";
		// Normal Advance
		a = y+m+d+"1";
		b = [];
		for(i=0; i<8; i++) {
			b[i] = Number(a[i+1])-Number(a[i]);
			if(b[i]<0) {
				b[i] = b[i]+10;
			}
		}
		chk = b.reduce(reducer)%10;
		bas = a[0];
		target2 = document.getElementById("main-content2");
		target2.innerHTML += "<p><a href='https://daikie.github.io/NCPDA/refill.html?ID=" + chk + bas + b.join("") +"'>Normal Advance</a></p>";
		// Gold Advance
		a = y+m+d+"2";
		b = [];
		for(i=0; i<8; i++) {
			b[i] = Number(a[i+1])-Number(a[i]);
			if(b[i]<0) {
				b[i] = b[i]+10;
			}
		}
		chk = b.reduce(reducer)%10;
		bas = a[0];
		target2 = document.getElementById("main-content2");
		target2.innerHTML += "<p><a href='https://daikie.github.io/NCPDA/refill.html?ID=" + chk + bas + b.join("") +"'>Gold Advance</a></p>";
	}

	function Escx(){
		const textbox = document.getElementById("url");
		var lnk = textbox.value;
		lnk = lnk.replace("!", "%21");
		target3 = document.getElementById("main-content3");
		target3.innerHTML = lnk;
		var dummy = document.createElement("textarea");
		document.body.appendChild(dummy);
		dummy.value = lnk;
	    dummy.select();
	    document.execCommand("copy");
	    document.body.removeChild(dummy);
	}
</script>

</head>
<body>

<body>
	<input type="button" value="Generate One Time Password!" onclick="Otpw()">
	<div class="container" id="main-content1"></div>

	<input type="button" value="Generate Advance Reservation Link!" onclick="Adv()">
	<div class="container" id="main-content2"></div>

	<input class="form-control" type="text" id="url">
	<input type="button" value="変換してコピー" onclick="Escx()">
	<div class="container" id="main-content3"></div>
</body>
</html>