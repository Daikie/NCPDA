<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="utf-8">
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Cache-Control" content="no-cache">
	<meta http-equiv="Expires" content="0">
	<meta name="viewport" content="width=device-width, user-scalable=no, maximum-scale=1" />
	<link rel="stylesheet" href="css/bootstrap.css">
	<link rel="stylesheet" href="css/styles.css">
	<title>西小山クリニック～同意書～</title>

	<script type="text/javascript">
		
		
	</script>


</head>
<body>

<body>
	<img src="img/excimer.png" width="619px" height="884px" class="img-fluid">
	<p>上記治療を受けることに同意される場合は以下にご署名をお願いします。</p>
	<div id="canvas"></div>
	<button id="clear">消去</button>
	<button id="qr">QRコードに変換</button>
	<div id="output"></div>
	<div id="qrcode"></div>

	<script src="js/jquery-3.5.1.min.js"></script>
	<script type="text/javascript" src="js/jquery.qrcode.min.js"></script>
	<script src="js/jSignature.min.js"></script>
	<script>

		$(document).ready(function() {
		    $("#canvas").jSignature({
				width: 500,
				height: 100,
				color: "#000",
				"background-color": "#FFE",
				lineWidth: 8
			});
		    $("#clear").click(function() {
				$("#canvas").jSignature("reset");
				$("#canvas.img").remove();
				$("#output").empty();
				$("#qrcode").empty();
			});
			
			$("#qr").click(function() {
				$("#output").empty();
				$("#qrcode").empty();
				var i = new Image();
				i.src = $("#canvas").jSignature("getData");
				const canvas = document.createElement('canvas');
        		canvas.width = 50;
        		canvas.height = 10;

        		i.onload = function onImageLoad() {
        			const ctx = canvas.getContext('2d');
        			ctx.drawImage(i,0,0,50,10);
        			const imgData = canvas.toDataURL("image/png");
        			var j = new Image();
        			j.src = imgData;
        			$(j).appendTo($("#output"));
					console.log(imgData.split(",")[1]);
					$("#qrcode").qrcode({width: 384, height: 384, text: imgData.split(",")[1]});
				}
			});
		});
		
	</script>
	<script src="js/bootstrap.js"></script>
</body>
</html>